<!DOCTYPE html>
<html>
<head>
  <meta charset="UTF-8">
  <title>Admin Dashboard - UN ENTERPRISES</title>
  <link rel="stylesheet" href="style.css">
</head>
<body>

<div class="container">
  <h2>Enquiries Dashboard</h2>

  <button onclick="logout()">Logout</button>

  <div id="enquiryList"></div>
</div>

<!-- Firebase -->
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-app.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-auth.js"></script>
<script src="https://www.gstatic.com/firebasejs/8.10.0/firebase-firestore.js"></script>

<script src="firebase-config.js"></script>

<script>

// üîê Protect page
firebase.auth().onAuthStateChanged(function(user){
  if (!user) {
    window.location.href = "admin.html";
  }
});

// Load enquiries
db.collection("enquiries").orderBy("createdAt","desc").onSnapshot(function(snapshot){
  var html = "";

  snapshot.forEach(function(doc){
    var data = doc.data();

    html += `
      <div style="border:1px solid #ccc; padding:15px; margin:10px 0;">
        <b>Name:</b> ${data.name} <br>
        <b>Email:</b> ${data.email} <br>
        <b>Phone:</b> ${data.phone} <br>
        <b>Message:</b> ${data.message} <br><br>
        <button onclick="deleteEnquiry('${doc.id}')">Delete</button>
      </div>
    `;
  });

  document.getElementById("enquiryList").innerHTML = html;
});

// Delete
function deleteEnquiry(id){
  db.collection("enquiries").doc(id).delete();
}

// Logout
function logout(){
  firebase.auth().signOut().then(function(){
    window.location.href = "admin.html";
  });
}

</script>

</body>
</html>
